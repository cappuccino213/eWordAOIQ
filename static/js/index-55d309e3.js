import{v as V,x as X,y as Z,A as G}from"./element-plus-df419614.js";import{u as K}from"./loggedInfo-268f6dc2.js";import{_ as L}from"./index-66a691da.js";import{r as y,w as j,d as N,a4 as F,o as B,c as I,X as b,Q as d,a as D,W as g,u as i,F as z,V as R,a0 as ee,s as te,P as M,T as $,a7 as ae}from"./@vue-500f6e4a.js";import{d as P}from"./dayjs-d69067b3.js";import{g as oe,u as se}from"./dateChange-eb10ac1f.js";import{s as ne,c as re}from"./index-771e9942.js";import{u as le}from"./cellMouseEnter-f72a73da.js";import{u as ce}from"./deductScore-d679635c.js";import{u as ue}from"./initFormData-b064dc9f.js";import"./lodash-es-8e578a42.js";import"./@element-plus-58134fba.js";import"./@popperjs-892fd7f5.js";import"./@ctrl-eb0b847c.js";import"./async-validator-efc2d198.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./@floating-ui-d1015eb5.js";import"./pinia-d75d73cf.js";import"./index-f3494083.js";import"./axios-805d1980.js";import"./vue-router-a3c91db2.js";import"./lodash-4ca21166.js";import"./pinia-plugin-persistedstate-4761f546.js";const ie=[{label:"\u7985\u9053ID",prop:"ztId",align:"center",slot:"ztId"},{label:"\u7F3A\u9677\u7B49\u7EA7",prop:"severity",align:"center",sortable:!0},{label:"\u7F3A\u9677\u6807\u9898",prop:"title",align:"center",showOverflowTooltip:!0},{label:"\u6240\u5C5E\u9879\u76EE",prop:"projectId",align:"center",sortable:!0,showOverflowTooltip:!0},{label:"\u521B\u5EFA\u4EBA",prop:"openedBy",align:"center"},{label:"\u89E3\u51B3\u4EBA",prop:"resolvedBy",align:"center"},{label:"\u89E3\u51B3\u65E5\u671F",prop:"resolvedDate",align:"center"}];const de=R("\u8FD4\u56DE"),pe=["onClick"],ve={__name:"index",props:{detailTableData:{type:Object,default:{}}},emits:["backClick"],setup(t,{expose:e,emit:s}){const c=t,r=K();let v=y([]);j(()=>c.detailTableData,n=>{v.value=n}),N(()=>{C()});const C=()=>{let n=JSON.parse(JSON.stringify(c.detailTableData));n.forEach(o=>{for(let a=0;a<r.userList.length;a++)o.openedBy===r.userList[a].account&&(o.openedBy=r.userList[a].realname),o.resolvedBy===r.userList[a].account&&(o.resolvedBy=r.userList[a].realname);for(let a=0;a<r.prjectList.length;a++)o.projectId===r.prjectList[a].id&&(o.projectId=r.prjectList[a].name)}),v.value=n},x=()=>{s("backClick")},H=n=>{window.open(n)};return e({getTableData:C}),(n,o)=>{const a=V,_=F("e-table");return B(),I(z,null,[b(a,{type:"primary",plain:"",onClick:x,size:"small",style:{"margin-bottom":"10px"}},{default:d(()=>[de]),_:1}),D("div",null,[b(_,{options:i(ie),data:i(v),stripe:"",border:""},{ztId:d(({scope:l})=>[D("div",{class:"ztId",onClick:w=>H(l.row.accessLink)},g(l.row.ztId),9,pe)]),_:1},8,["options","data"])])],64)}}},_e=L(ve,[["__scopeId","data-v-7fa27b1c"]]),me=[{type:"select",value:[],label:"\u59D3\u540D",prop:"resolvedBy",attrs:{style:{width:"100%"},multiple:!0,collapseTags:!0},rules:[{required:!0,message:"\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],children:[],multiple:!0},{type:"date-picker",value:[P(new Date(oe()).setHours(0,0,0)).format("YYYY-MM-DD HH:mm:ss"),P(new Date().setHours(23,59,59)).format("YYYY-MM-DD HH:mm:ss")],label:"\u65F6\u95F4",prop:"dateRange",rules:[{required:!0,message:"\u65E5\u671F\u9009\u62E9\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],attrs:{style:{width:"100%"},multiple:!0,collapseTags:!0,type:"daterange",rangeSeparator:"\u81F3",startPlaceholder:"\u5F00\u59CB\u65E5\u671F",endPlaceholder:"\u7ED3\u675F\u65E5\u671F",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD HH:mm:ss",shortcuts:[{text:"\u4ECA\u5929",value:()=>{const t=new Date().setHours(0,0,0),e=new Date().setHours(23,59,59);return[t,e]}},{text:"\u4E00\u5468\u5185",value:()=>{const t=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*7);return[new Date(e).setHours(0,0,0),t]}},{text:"\u4E00\u6708\u5185",value:()=>{const t=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*30);return[new Date(e).setHours(0,0,0),t]}},{text:"\u534A\u5E74\u5185",value:()=>{const t=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*182);return[new Date(e).setHours(0,0,0),t]}},{text:"\u4E00\u5E74\u5185",value:()=>{const t=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*365);return[new Date(e).setHours(0,0,0),t]}},{text:"\u7B2C\u4E00\u5B63\u5EA6",value:()=>{var t=new Date,e=t.getFullYear();const s=new Date(e,0,1).setHours(0,0,0),c=new Date(e,2,31).setHours(23,59,59);return[s,c]}},{text:"\u7B2C\u4E8C\u5B63\u5EA6",value:()=>{var t=new Date,e=t.getFullYear();const s=new Date(e,3,1).setHours(0,0,0),c=new Date(e,5,30).setHours(23,59,59);return[s,c]}},{text:"\u7B2C\u4E09\u5B63\u5EA6",value:()=>{var t=new Date,e=t.getFullYear();const s=new Date(e,6,1).setHours(0,0,0),c=new Date(e,8,30).setHours(23,59,59);return[s,c]}},{text:"\u7B2C\u56DB\u5B63\u5EA6",value:()=>{var t=new Date,e=t.getFullYear();const s=new Date(e,9,1).setHours(0,0,0),c=new Date(e,11,31).setHours(23,59,59);return[s,c]}}]}}],ge=[{label:"\u59D3\u540D",prop:"resolvedBy",align:"center"},{label:"\u7F3A\u9677\u603B\u6570",prop:"bugTotal",align:"center",sortable:!0},{label:"\u4E25\u91CD\u7F3A\u9677\u6570",prop:"severityBugCount",align:"center",sortable:!0,slot:"severityBugCount"},{label:"\u4E25\u91CD\u7F3A\u9677\u6BD4\u4F8B",prop:"severityBugRate",align:"center",slot:"severityBugRate",sortable:!0,sortMethod:(t,e)=>parseInt(t-e)},{label:"\u6263\u5206\u6570",prop:"deductPoint",align:"center",sortable:!0,slot:"deductPoint"}];const be={class:"wrapper targetSetpage-wrapper"},fe=R("\u67E5\u8BE2"),De=R("\u91CD\u7F6E"),ye=["onClick"],we={class:"deRule"},he={class:"ruleRange"},Te={class:"result"},Be={class:"deductPoint"},Ce={__name:"index",emits:["addTab"],setup(t,{emit:e}){const[s,c,r]=se(),[v,C]=le("severityBugRate"),[x,H,n,o]=ce(),a=ue(),_=y(null);let l=y(me),w=y([]),k=ee({resolvedBy:[],resolvedBeginDate:"",resolvedEndDate:""}),E=y([]);j(()=>v.value,u=>{o("devSeverityBug",u)}),N(()=>{a(l.value),S(k),o("devSeverityBug",v.value)});const S=u=>{const p=l.value[0].children;ne(u).then(h=>{const T=h.data;T&&T.length&&(E.value=T.map(m=>{for(let Y of p)m.resolvedBy===Y.value&&(m.account=m.resolvedBy,m.resolvedBy=Y.label);return m.severityBugRate=m.severityBugRate*100,m}))})},q=async u=>{await re(u).then(p=>{p.data&&(w.value=p.data)})},J=u=>{const p=u.model,h=u.model.dateRange;u.form.validate(T=>{T&&(k.resolvedBy=p.resolvedBy,k.resolvedBeginDate=s.value||h[0],k.resolvedEndDate=c.value||h[1],S(k))})},A=u=>{s.value="",c.value="",a(l.value),E.value=[]},Q=u=>{},U=u=>{r(u)},W=async u=>{w.value=[];let p=JSON.parse(JSON.stringify(k));p.resolvedBy=u,console.log(p),await q(p),e("addTab",w.value)};return(u,p)=>{const h=V,T=F("e-form"),m=X,Y=F("e-table");return B(),I("div",be,[b(T,{ref_key:"form",ref:_,options:i(l),onVisibleChange:Q,onDateChange:U},{action:d(f=>[b(h,{type:"primary",onClick:O=>J(f)},{default:d(()=>[fe]),_:2},1032,["onClick"]),b(h,{onClick:O=>A()},{default:d(()=>[De]),_:2},1032,["onClick"])]),_:1},8,["options"]),b(Y,{options:i(ge),data:i(E),stripe:"",border:"",onCellMouseEnter:i(C)},{severityBugRate:d(({scope:f})=>[R(g(f.row.severityBugRate.toFixed(2))+"%",1)]),severityBugCount:d(({scope:f})=>[D("div",{class:"bugCount",onClick:O=>W(f.row.account)},g(f.row.severityBugCount),9,ye)]),deductPoint:d(({scope:f})=>[b(m,{placement:"top","hide-after":150},{content:d(()=>[D("div",null,[D("div",we,"\u6263\u5206\u89C4\u5219\uFF1A"+g(i(x).rule),1),D("div",he," \u6263\u5206\u8303\u56F4\uFF1A"+g(i(x).scoreInterval),1),D("div",Te," \u5F53\u524D\u8003\u6838\u6307\u6807 "+g(i(v).toFixed(2))+"% \u5728"+g(i(H))+"\u8303\u56F4\uFF0C\u6545\u6263"+g(i(n))+"\u5206 ",1)])]),default:d(()=>[D("div",Be,g(f.row.deductPoint),1)]),_:2},1024)]),_:1},8,["options","data","onCellMouseEnter"])])}}},xe=L(Ce,[["__scopeId","data-v-93c42a80"]]);const ke={class:"wrapper"},He={__name:"index",setup(t){const e=te([]);let s=y([]);const c=y(null),r=y("\u7EDF\u8BA1\u9875"),v=n=>{if(s.value=n,console.log(n),e.value.length)r.value="\u8BE6\u60C5\u9875";else{const o="\u8BE6\u60C5\u9875";e.value.push({content:_e,name:"\u8BE6\u60C5\u9875",title:"\u8BE6\u60C5\u9875"}),r.value=o}},C=n=>{const o=e.value;let a=r.value;a===n&&o.forEach((_,l)=>{if(_.name===n){const w=o[l+1]||o[l-1];w&&(a=w.name)}}),r.value="\u7EDF\u8BA1\u9875",e.value=o.filter(_=>_.name!==n)},x=()=>{r.value="\u7EDF\u8BA1\u9875"},H=n=>{n==="\u8BE6\u60C5\u9875"&&c.value[0].getTableData()};return(n,o)=>{const a=Z,_=G;return B(),I("div",ke,[b(_,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=l=>r.value=l),type:"card",class:"demo-tabs",onTabRemove:C,onTabChange:H},{default:d(()=>[b(a,{label:"\u7EDF\u8BA1\u9875",name:"\u7EDF\u8BA1\u9875"},{default:d(()=>[(B(),M($(i(xe)),{onAddTab:v},null,32))]),_:1}),(B(!0),I(z,null,ae(i(e),l=>(B(),M(a,{key:l.name,label:l.title,name:l.name,closable:""},{default:d(()=>[(B(),M($(l.content),{onBackClick:x,detailTableData:i(s),ref_for:!0,ref_key:"detailRef",ref:c},null,40,["detailTableData"]))]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}}},et=L(He,[["__scopeId","data-v-f00c3ef9"]]);export{et as default};
