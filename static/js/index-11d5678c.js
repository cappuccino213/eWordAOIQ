import{v as V,x as X,y as Z,A as G}from"./element-plus-df419614.js";import{u as K}from"./loggedInfo-268f6dc2.js";import{_ as E}from"./index-66a691da.js";import{r as g,w as j,d as B,a4 as M,o as k,c as P,X as b,Q as d,a as D,W as f,u,F as q,V as R,a0 as ee,s as te,P as I,T as $,a7 as ae}from"./@vue-500f6e4a.js";import{d as N}from"./dayjs-d69067b3.js";import{g as oe,u as se}from"./dateChange-eb10ac1f.js";import{e as ne,f as re}from"./index-771e9942.js";import{u as le}from"./cellMouseEnter-f72a73da.js";import{u as ce}from"./deductScore-d679635c.js";import{u as ie}from"./initFormData-b064dc9f.js";import"./lodash-es-8e578a42.js";import"./@element-plus-58134fba.js";import"./@popperjs-892fd7f5.js";import"./@ctrl-eb0b847c.js";import"./async-validator-efc2d198.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./@floating-ui-d1015eb5.js";import"./pinia-d75d73cf.js";import"./index-f3494083.js";import"./axios-805d1980.js";import"./vue-router-a3c91db2.js";import"./lodash-4ca21166.js";import"./pinia-plugin-persistedstate-4761f546.js";const ue=[{label:"\u6D4B\u8BD5\u5355ID",prop:"testTaskID",align:"center",slot:"testTaskID",sortable:!0},{label:"\u6807\u9898",prop:"title",align:"center",showOverflowTooltip:!0},{label:"\u6240\u5C5E\u4EA7\u54C1",prop:"product",align:"center"},{label:"\u6240\u5C5E\u9879\u76EE",prop:"project",align:"center",showOverflowTooltip:!0},{label:"\u7248\u672C\u53F7",prop:"build",align:"center"},{label:"\u6D4B\u8BD5\u4EBA",prop:"tester",align:"center"},{label:"\u5931\u8D25\u539F\u56E0",prop:"failedReason",align:"center"},{label:"\u5931\u8D25\u8D23\u4EFB\u4EBA",prop:"relatedPerson",align:"center"},{label:"\u5F00\u59CB\u65E5\u671F",prop:"begin",align:"center",sortable:!0},{label:"\u7ED3\u675F\u65E5\u671F",prop:"begin",align:"center",sortable:!0}];const de=R("\u8FD4\u56DE"),pe=["onClick"],me={__name:"index",props:{detailTableData:{type:Object,default:{}}},emits:["backClick"],setup(o,{expose:e,emit:n}){const c=o,s=K();let _=g([]);j(()=>c.detailTableData,r=>{_.value=r}),B(()=>{C()});const C=()=>{let r=JSON.parse(JSON.stringify(c.detailTableData));r.forEach(a=>{for(let t=0;t<s.userList.length;t++)a.tester===s.userList[t].account&&(a.tester=s.userList[t].realname),a.relatedPerson===s.userList[t].account&&(a.relatedPerson=s.userList[t].realname);for(let t=0;t<s.prjectList.length;t++)a.project===s.prjectList[t].id&&(a.project=s.prjectList[t].name);for(let t=0;t<s.prodList.length;t++)a.product===s.prodList[t].id&&(a.product=s.prodList[t].name)}),_.value=r},y=()=>{n("backClick")},H=r=>{window.open(r)};return e({getTableData:C}),(r,a)=>{const t=V,v=M("e-table");return k(),P(q,null,[b(t,{type:"primary",plain:"",onClick:y,size:"small",style:{"margin-bottom":"10px"}},{default:d(()=>[de]),_:1}),D("div",null,[b(v,{options:u(ue),data:u(_),stripe:"",border:""},{testTaskID:d(({scope:l})=>[D("div",{class:"testTaskID",onClick:p=>H(l.row.accessLink)},f(l.row.testTaskID),9,pe)]),_:1},8,["options","data"])])],64)}}},_e=E(me,[["__scopeId","data-v-96ce869a"]]),ve=[{type:"select",value:[],label:"\u59D3\u540D",prop:"devName",attrs:{style:{width:"100%"},multiple:!0,collapseTags:!0},rules:[{required:!0,message:"\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],children:[],multiple:!0},{type:"date-picker",value:[N(new Date(oe()).setHours(0,0,0)).format("YYYY-MM-DD HH:mm:ss"),N(new Date().setHours(23,59,59)).format("YYYY-MM-DD HH:mm:ss")],label:"\u65F6\u95F4",prop:"dateRange",rules:[{required:!0,message:"\u65E5\u671F\u9009\u62E9\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],attrs:{style:{width:"100%"},multiple:!0,collapseTags:!0,type:"daterange",rangeSeparator:"\u81F3",startPlaceholder:"\u5F00\u59CB\u65E5\u671F",endPlaceholder:"\u7ED3\u675F\u65E5\u671F",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD HH:mm:ss",shortcuts:[{text:"\u4ECA\u5929",value:()=>{const o=new Date().setHours(0,0,0),e=new Date().setHours(23,59,59);return[o,e]}},{text:"\u4E00\u5468\u5185",value:()=>{const o=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*7);return[new Date(e).setHours(0,0,0),o]}},{text:"\u4E00\u6708\u5185",value:()=>{const o=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*30);return[new Date(e).setHours(0,0,0),o]}},{text:"\u534A\u5E74\u5185",value:()=>{const o=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*182);return[new Date(e).setHours(0,0,0),o]}},{text:"\u4E00\u5E74\u5185",value:()=>{const o=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*365);return[new Date(e).setHours(0,0,0),o]}},{text:"\u7B2C\u4E00\u5B63\u5EA6",value:()=>{var o=new Date,e=o.getFullYear();const n=new Date(e,0,1).setHours(0,0,0),c=new Date(e,2,31).setHours(23,59,59);return[n,c]}},{text:"\u7B2C\u4E8C\u5B63\u5EA6",value:()=>{var o=new Date,e=o.getFullYear();const n=new Date(e,3,1).setHours(0,0,0),c=new Date(e,5,30).setHours(23,59,59);return[n,c]}},{text:"\u7B2C\u4E09\u5B63\u5EA6",value:()=>{var o=new Date,e=o.getFullYear();const n=new Date(e,6,1).setHours(0,0,0),c=new Date(e,8,30).setHours(23,59,59);return[n,c]}},{text:"\u7B2C\u56DB\u5B63\u5EA6",value:()=>{var o=new Date,e=o.getFullYear();const n=new Date(e,9,1).setHours(0,0,0),c=new Date(e,11,31).setHours(23,59,59);return[n,c]}}]}}],be=[{label:"\u59D3\u540D",prop:"relatedPerson",align:"center"},{label:"\u5192\u70DF\u5931\u8D25\u6570",prop:"smokeTestFailCount",align:"center",sortable:!0,slot:"smokeTestFailCount"},{label:"\u6263\u5206\u6570",prop:"deductPoint",align:"center",sortable:!0,slot:"deductPoint"}];const fe={class:"wrapper targetSetpage-wrapper"},De=R("\u67E5\u8BE2"),ge=R("\u91CD\u7F6E"),we=["onClick"],Te={class:"deRule"},he={class:"ruleRange"},ke={class:"result"},Ce={class:"deductPoint"},ye={__name:"index",emits:["addTab"],setup(o,{emit:e}){const[n,c,s]=se(),[_,C]=le("smokeTestFailCount"),[y,H,r,a]=ce(),t=ie(),v=g(null);let l=g(ve),p=ee({relatedPerson:[],begin:"",end:""}),F=g([]),L=g([]);j(()=>_.value,i=>{a("devSmokeTest",i)}),B(()=>{t(l.value),S(p),a("devSmokeTest",_.value)});const S=i=>{const m=l.value[0].children;ne(i).then(w=>{const T=w.data;T&&T.length&&(F.value=T.map(h=>{for(let Y of m)h.relatedPerson===Y.value&&(h.account=h.relatedPerson,h.relatedPerson=Y.label);return h}))})},J=async i=>{await re(i).then(m=>{m.data&&(L.value=m.data)})},A=i=>{const m=i.model,w=i.model.dateRange;i.form.validate(T=>{T&&(p.relatedPerson=m.devName,p.begin=n.value||w[0],p.end=c.value||w[1],S(p))})},z=i=>{n.value="",c.value="",t(l.value),F.value=[]},Q=i=>{},U=i=>{s(i)},W=async i=>{L.value=[];let m=JSON.parse(JSON.stringify(p));m.relatedPerson=i,await J(m),e("addTab",L.value)};return(i,m)=>{const w=V,T=M("e-form"),h=X,Y=M("e-table");return k(),P("div",fe,[b(T,{ref_key:"form",ref:v,options:u(l),onVisibleChange:Q,onDateChange:U},{action:d(x=>[b(w,{type:"primary",onClick:O=>A(x)},{default:d(()=>[De]),_:2},1032,["onClick"]),b(w,{onClick:O=>z()},{default:d(()=>[ge]),_:2},1032,["onClick"])]),_:1},8,["options"]),b(Y,{options:u(be),data:u(F),stripe:"",border:"",onCellMouseEnter:u(C)},{smokeTestFailCount:d(({scope:x})=>[D("div",{class:"failCount",onClick:O=>W(x.row.account)},f(x.row.smokeTestFailCount),9,we)]),deductPoint:d(({scope:x})=>[b(h,{placement:"top","hide-after":150},{content:d(()=>[D("div",null,[D("div",Te,"\u6263\u5206\u89C4\u5219\uFF1A"+f(u(y).rule),1),D("div",he," \u6263\u5206\u8303\u56F4\uFF1A"+f(u(y).scoreInterval),1),D("div",ke," \u5F53\u524D\u8003\u6838\u6307\u6807 "+f(u(_))+" \u5728"+f(u(H))+"\u8303\u56F4\uFF0C\u6545\u6263"+f(u(r))+"\u5206 ",1)])]),default:d(()=>[D("div",Ce,f(x.row.deductPoint),1)]),_:2},1024)]),_:1},8,["options","data","onCellMouseEnter"])])}}},xe=E(ye,[["__scopeId","data-v-1624838a"]]);const He={class:"wrapper"},Ye={__name:"index",setup(o){const e=te([]);let n=g([]);const c=g(null),s=g("\u7EDF\u8BA1\u9875"),_=r=>{if(n.value=r,console.log(r),e.value.length)s.value="\u8BE6\u60C5\u9875";else{const a="\u8BE6\u60C5\u9875";e.value.push({content:_e,name:"\u8BE6\u60C5\u9875",title:"\u8BE6\u60C5\u9875"}),s.value=a}},C=r=>{const a=e.value;let t=s.value;t===r&&a.forEach((v,l)=>{if(v.name===r){const p=a[l+1]||a[l-1];p&&(t=p.name)}}),s.value="\u7EDF\u8BA1\u9875",e.value=a.filter(v=>v.name!==r)},y=()=>{s.value="\u7EDF\u8BA1\u9875"},H=r=>{r==="\u8BE6\u60C5\u9875"&&c.value[0].getTableData()};return(r,a)=>{const t=Z,v=G;return k(),P("div",He,[b(v,{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=l=>s.value=l),type:"card",class:"demo-tabs",onTabRemove:C,onTabChange:H},{default:d(()=>[b(t,{label:"\u7EDF\u8BA1\u9875",name:"\u7EDF\u8BA1\u9875"},{default:d(()=>[(k(),I($(u(xe)),{onAddTab:_},null,32))]),_:1}),(k(!0),P(q,null,ae(u(e),l=>(k(),I(t,{key:l.name,label:l.title,name:l.name,closable:""},{default:d(()=>[(k(),I($(l.content),{onBackClick:y,detailTableData:u(n),ref_for:!0,ref_key:"detailRef",ref:c},null,40,["detailTableData"]))]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}}},et=E(Ye,[["__scopeId","data-v-48ebb6c6"]]);export{et as default};
