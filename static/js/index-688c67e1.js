import{v as P,x as X,y as Z,A as G}from"./element-plus-df419614.js";import{u as K}from"./loggedInfo-268f6dc2.js";import{_ as L}from"./index-66a691da.js";import{r as D,w as j,d as N,a4 as M,o as T,c as I,X as g,Q as d,a as f,W as b,u,F as z,V as F,a0 as ee,s as te,P as E,T as V,a7 as ae}from"./@vue-500f6e4a.js";import{d as $}from"./dayjs-d69067b3.js";import{g as ne,u as oe}from"./dateChange-eb10ac1f.js";import{i as se,I as le}from"./index-685d72d8.js";import{u as re}from"./cellMouseEnter-f72a73da.js";import{u as ce}from"./deductScore-d679635c.js";import{u as ie}from"./initFormData-b064dc9f.js";import"./lodash-es-8e578a42.js";import"./@element-plus-58134fba.js";import"./@popperjs-892fd7f5.js";import"./@ctrl-eb0b847c.js";import"./async-validator-efc2d198.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./@floating-ui-d1015eb5.js";import"./pinia-d75d73cf.js";import"./index-f3494083.js";import"./axios-805d1980.js";import"./vue-router-a3c91db2.js";import"./lodash-4ca21166.js";import"./pinia-plugin-persistedstate-4761f546.js";const ue=[{label:"\u7985\u9053ID",prop:"ztId",align:"center",slot:"ztId",sortable:!0},{label:"\u7F3A\u9677\u6807\u9898",prop:"title",align:"center",showOverflowTooltip:!0},{label:"\u6240\u5C5E\u9879\u76EE",prop:"projectId",align:"center",sortable:!0,showOverflowTooltip:!0},{label:"\u521B\u5EFA\u4EBA",prop:"openedBy",align:"center"},{label:"\u521B\u5EFA\u65E5\u671F",prop:"openedDate",align:"center",sortable:!0},{label:"\u89E3\u51B3\u4EBA",prop:"resolvedBy",align:"center"},{label:"\u65E0\u6548\u539F\u56E0",prop:"resolution",align:"center"}];const de=F("\u8FD4\u56DE"),pe=["onClick"],_e={__name:"index",props:{detailTableData:{type:Object,default:[]}},emits:["backClick"],setup(a,{expose:e,emit:o}){const i=a,l=K();let _=D([]);j(()=>i.detailTableData,s=>{_.value=[],_.value=s}),N(()=>{C()});const C=()=>{let s=JSON.parse(JSON.stringify(i.detailTableData));s.forEach(n=>{for(let t=0;t<l.userList.length;t++)n.openedBy===l.userList[t].account&&(n.openedBy=l.userList[t].realname),n.resolvedBy===l.userList[t].account&&(n.resolvedBy=l.userList[t].realname);for(let t=0;t<l.prjectList.length;t++)n.projectId===l.prjectList[t].id&&(n.projectId=l.prjectList[t].name)}),_.value=s},B=()=>{o("backClick")},H=s=>{window.open(s)};return e({getTableData:C}),(s,n)=>{const t=P,m=M("e-table");return T(),I(z,null,[g(t,{type:"primary",plain:"",onClick:B,size:"small",style:{"margin-bottom":"10px"}},{default:d(()=>[de]),_:1}),f("div",null,[g(m,{options:u(ue),data:u(_),stripe:"",border:""},{ztId:d(({scope:r})=>[f("div",{class:"ztId",onClick:w=>H(r.row.accessLink)},b(r.row.ztId),9,pe)]),_:1},8,["options","data"])])],64)}}},me=L(_e,[["__scopeId","data-v-90c8633f"]]),ve=[{type:"select",value:[],label:"\u59D3\u540D",prop:"resolvedBy",attrs:{style:{width:"100%"},multiple:!0,collapseTags:!0},rules:[{required:!0,message:"\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],children:[],multiple:!0},{type:"date-picker",value:[$(new Date(ne()).setHours(0,0,0)).format("YYYY-MM-DD HH:mm:ss"),$(new Date().setHours(23,59,59)).format("YYYY-MM-DD HH:mm:ss")],label:"\u65F6\u95F4",prop:"dateRange",rules:[{required:!0,message:"\u65E5\u671F\u9009\u62E9\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],attrs:{style:{width:"100%"},multiple:!0,collapseTags:!0,type:"daterange",rangeSeparator:"\u81F3",startPlaceholder:"\u5F00\u59CB\u65E5\u671F",endPlaceholder:"\u7ED3\u675F\u65E5\u671F",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD HH:mm:ss",shortcuts:[{text:"\u4ECA\u5929",value:()=>{const a=new Date().setHours(0,0,0),e=new Date().setHours(23,59,59);return[a,e]}},{text:"\u4E00\u5468\u5185",value:()=>{const a=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*7);return[new Date(e).setHours(0,0,0),a]}},{text:"\u4E00\u6708\u5185",value:()=>{const a=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*30);return[new Date(e).setHours(0,0,0),a]}},{text:"\u534A\u5E74\u5185",value:()=>{const a=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*182);return[new Date(e).setHours(0,0,0),a]}},{text:"\u4E00\u5E74\u5185",value:()=>{const a=new Date().setHours(23,59,59),e=new Date().setTime(new Date().getTime()-3600*1e3*24*365);return[new Date(e).setHours(0,0,0),a]}},{text:"\u7B2C\u4E00\u5B63\u5EA6",value:()=>{var a=new Date,e=a.getFullYear();const o=new Date(e,0,1).setHours(0,0,0),i=new Date(e,2,31).setHours(23,59,59);return[o,i]}},{text:"\u7B2C\u4E8C\u5B63\u5EA6",value:()=>{var a=new Date,e=a.getFullYear();const o=new Date(e,3,1).setHours(0,0,0),i=new Date(e,5,30).setHours(23,59,59);return[o,i]}},{text:"\u7B2C\u4E09\u5B63\u5EA6",value:()=>{var a=new Date,e=a.getFullYear();const o=new Date(e,6,1).setHours(0,0,0),i=new Date(e,8,30).setHours(23,59,59);return[o,i]}},{text:"\u7B2C\u56DB\u5B63\u5EA6",value:()=>{var a=new Date,e=a.getFullYear();const o=new Date(e,9,1).setHours(0,0,0),i=new Date(e,11,31).setHours(23,59,59);return[o,i]}}],defaultValue:new Date}}],ge=[{label:"\u59D3\u540D",prop:"openedBy",align:"center"},{label:"\u7F3A\u9677\u603B\u6570",prop:"bugTotal",align:"center"},{label:"\u65E0\u6548\u7F3A\u9677\u6570",prop:"invalidBugCount",align:"center",slot:"invalidBugCount"},{label:"\u65E0\u6548\u7F3A\u9677\u6BD4",prop:"invalidBugRate",align:"center"},{label:"\u6263\u5206\u6570",prop:"deductPoint",align:"center",slot:"deductPoint"}];const be={class:"wrapper targetSetpage-wrapper"},fe=F("\u67E5\u8BE2"),De=F("\u91CD\u7F6E"),we=["onClick"],ye={class:"deRule"},he={class:"ruleRange"},Te={class:"result"},Ce={class:"deductPoint"},Be={__name:"index",emits:["addTab"],setup(a,{emit:e}){const[o,i,l]=oe(),[_,C]=re("invalidBugRate"),[B,H,s,n]=ce(),t=ie(),m=D(null);let r=D(ve),w=D([]),x=ee({openedBy:[],openedBeginDate:"",openedEndDate:""}),R=D([]);j(()=>_.value,c=>{n("testInvalidBug",c)}),N(()=>{t(r.value,"test"),O(x),n("testInvalidBug",_.value)});const O=c=>{const p=r.value[0].children;se(c).then(y=>{const h=y.data;h&&h.length&&(R.value=h.map(v=>{console.log(v);for(let Y of p)v.openedBy===Y.value&&(v.openedBy=Y.label,v.account=Y.value);return v.invalidBugRate=(v.invalidBugRate*100).toFixed(2)+"%",v}))})},q=async c=>{await le(c).then(p=>{p.data&&(w.value=p.data)})},J=c=>{const p=c.model,y=c.model.dateRange;c.form.validate(h=>{h&&(x.openedBy=p.resolvedBy,x.openedBeginDate=o.value||y[0],x.openedEndDate=i.value||y[1],O(x))})},A=c=>{o.value="",i.value="",t(r.value,"test"),R.value=[]},Q=c=>{},U=c=>{l(c)},W=async c=>{console.log(c),w.value=[];let p=JSON.parse(JSON.stringify(x));p.openedBy=c,console.log(p),await q(p),e("addTab",w.value)};return(c,p)=>{const y=P,h=M("e-form"),v=X,Y=M("e-table");return T(),I("div",be,[g(h,{ref_key:"form",ref:m,options:u(r),onVisibleChange:Q,onDateChange:U},{action:d(k=>[g(y,{type:"primary",onClick:S=>J(k)},{default:d(()=>[fe]),_:2},1032,["onClick"]),g(y,{onClick:S=>A()},{default:d(()=>[De]),_:2},1032,["onClick"])]),_:1},8,["options"]),g(Y,{options:u(ge),data:u(R),stripe:"",border:"",onCellMouseEnter:u(C)},{invalidBugCount:d(({scope:k})=>[f("div",{class:"bugCount",onClick:S=>W(k.row.account)},b(k.row.invalidBugCount),9,we)]),deductPoint:d(({scope:k})=>[g(v,{placement:"top","hide-after":150},{content:d(()=>[f("div",null,[f("div",ye,"\u6263\u5206\u89C4\u5219\uFF1A"+b(u(B).rule),1),f("div",he," \u6263\u5206\u8303\u56F4\uFF1A"+b(u(B).scoreInterval),1),f("div",Te," \u5F53\u524D\u8003\u6838\u6307\u6807 "+b(u(_))+" \u5728"+b(u(H))+"\u8303\u56F4\uFF0C\u6545\u6263"+b(u(s))+"\u5206 ",1)])]),default:d(()=>[f("div",Ce,b(k.row.deductPoint),1)]),_:2},1024)]),_:1},8,["options","data","onCellMouseEnter"])])}}},xe=L(Be,[["__scopeId","data-v-9c4e382f"]]);const ke={class:"wrapper"},He={__name:"index",setup(a){const e=te([]);let o=D([]);const i=D(null),l=D("\u7EDF\u8BA1\u9875"),_=s=>{if(o.value=s,console.log(s),e.value.length)l.value="\u8BE6\u60C5\u9875";else{const n="\u8BE6\u60C5\u9875";e.value.push({content:me,name:"\u8BE6\u60C5\u9875",title:"\u8BE6\u60C5\u9875"}),l.value=n}},C=s=>{const n=e.value;let t=l.value;t===s&&n.forEach((m,r)=>{if(m.name===s){const w=n[r+1]||n[r-1];w&&(t=w.name)}}),l.value="\u7EDF\u8BA1\u9875",e.value=n.filter(m=>m.name!==s)},B=()=>{l.value="\u7EDF\u8BA1\u9875"},H=s=>{s==="\u8BE6\u60C5\u9875"&&i.value[0].getTableData()};return(s,n)=>{const t=Z,m=G;return T(),I("div",ke,[g(m,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=r=>l.value=r),type:"card",class:"demo-tabs",onTabRemove:C,onTabChange:H},{default:d(()=>[g(t,{label:"\u7EDF\u8BA1\u9875",name:"\u7EDF\u8BA1\u9875"},{default:d(()=>[(T(),E(V(u(xe)),{onAddTab:_},null,32))]),_:1}),(T(!0),I(z,null,ae(u(e),r=>(T(),E(t,{key:r.name,label:r.title,name:r.name,closable:""},{default:d(()=>[(T(),E(V(r.content),{onBackClick:B,detailTableData:u(o),ref_for:!0,ref_key:"detailRef",ref:i},null,40,["detailTableData"]))]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}}},et=L(He,[["__scopeId","data-v-59b25757"]]);export{et as default};
